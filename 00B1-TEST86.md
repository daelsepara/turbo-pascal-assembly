# Test for 8086/80186/80286

Checks CPU type based on whether or not the upper bits of the flags are over-written.

```
0770:00B1 33C0          XOR	AX,AX  
```

AX = 0, processor is at least an 8086

```
0770:00B3 9C            PUSHF	       
0770:00B4 5B            POP	BX     
0770:00B5 80E70F        AND	BH,0F
0770:00B8 53            PUSH	BX     
0770:00B9 9D            POPF	       
0770:00BA 9C            PUSHF	       
0770:00BB 59            POP	CX     
0770:00BC 80E5F0        AND	CH,F0  
0770:00BF 80FDF0        CMP	CH,F0  
0770:00C2 740E          JZ	00D2   
```

Determine processor based on the flag bits

```
0770:00C4 40            INC	AX     
```

Processor type is at least an AT/80186.

```
0770:00C5 80CFF0        OR	BH,F0  
0770:00C8 53            PUSH	BX     
0770:00C9 9D            POPF	       
0770:00CA 9C            PUSHF	       
0770:00CB 59            POP	CX     
0770:00CC 80E5F0        AND	CH,F0  
0770:00CF 7401          JZ	00D2   
```

Test the flags again if they are overwritten.


```
0770:00D1 40            INC	AX
```

Processor type is at least a 80286.

```
0770:00D2 A24C00        MOV	[Test8086],AL
0770:00D5 C3            RET	       
```

Store result in DATA:[Test8086] then return to caller.

[Back](SYSTEM.md)